User: # 1. ROLE
You are a Senior API Architect and Technical Business Analyst specializing in RESTful API Design, Domain-Driven Design (DDD), and OpenAPI Specification (OAS 3.0). You bridge the gap between business needs and technical implementation.

# 2. CONTEXT
We are developing a high-scale E-commerce Microservices Platform using Spring Boot. We adhere to a strict "Contract-First" development methodology. The goal is to create a flawless API definition for the `order-service` before any code is written.

# 3. TASK
Analyze the business requirements provided inside the <requirements> tags. Based on these requirements, generate a complete, valid, and production-ready **OpenAPI 3.0.1 YAML** document.

# 4. CONSTRAINTS & STANDARDS
- **Spec Version:** Use OpenAPI 3.0.1.
- **Resource Naming:** Use plural nouns (e.g., `/orders`, `/orders/{id}/items`). Kebab-case for URLs.
- **Data Types:**
  - Use `format: uuid` for IDs.
  - Use `format: date-time` (ISO 8601) for timestamps.
  - Use `type: number, format: double` for monetary values.
- **Status Codes:**
  - `201 Created` for successful POST.
  - `204 No Content` for successful DELETE or PUT (if no body returned).
  - `400 Bad Request` for validation errors.
  - `404 Not Found` for missing resources.
  - `422 Unprocessable Entity` for business rule violations.
- **Error Handling:** You MUST use **RFC 7807 (Problem Details)** format for all error responses (4xx, 5xx).
- **Reusability:** heavily use `components/schemas` to avoid duplication. Do NOT inline complex objects.
- **Documentation:** Every field must have a `description` and an `example`.
- **Security:** Include a placeholder `securitySchemes` for `BearerAuth` (JWT).

# 5. FEW-SHOT EXAMPLES

<example_error_response>
# RFC 7807 Standard
type: object
properties:
  type:
    type: string
    example: "about:blank"
  title:
    type: string
    example: "Insufficient Stock"
  status:
    type: integer
    example: 422
  detail:
    type: string
    example: "Product ID 123 does not have enough stock to fulfill request."
  instance:
    type: string
    example: "/orders/987"
</example_error_response>

<example_schema>
OrderRequest:
  type: object
  required:
    - customerId
    - items
  properties:
    customerId:
      type: string
      format: uuid
      description: "Unique identifier of the customer"
    items:
      type: array
      items:
        $ref: '#/components/schemas/OrderItem'
</example_schema>

# 6. OUTPUT FORMAT
- Output ONLY the valid YAML code block.
- Start with `openapi: 3.0.1`.
- Do not add conversational filler before or after the code.

# 7. INPUT DATA
<requirements>
1. Kullanıcılar yeni bir sipariş oluşturabilmeli (Create Order). Sipariş oluştururken Müşteri ID, Adres Bilgisi ve Ürün Listesi (ID ve Adet) zorunludur.
2. Bir siparişin detayı ID ile sorgulanabilmeli (Get Order).
3. Kullanıcı siparişini "İptal" edebilmeli, ancak kargoya verilmişse iptal edilemez (Cancel Order).
4. Sistem siparişin statüsünü (Hazırlanıyor, Kargoda, Teslim Edildi) güncelleyebilmeli.
5. Hata durumunda (örneğin stok yoksa) detaylı hata mesajı dönmeli.
</requirements>

GitHub Copilot: I'll analyze the requirements and create a complete OpenAPI 3.0.1 specification for the order-service. Let me first check the existing contract. 

Read [](file:///c%3A/Users/PC1/Desktop/Projects/Education/Java/turkcell-ai-2/docs/openapi/order-service.yaml)

Perfect! The file is empty. Now let me create the complete OpenAPI specification based on the requirements.

## Analysis & Plan

**Requirements Translation:**
1. **POST /orders** - Create order (customerId, address, items[productId, quantity])
2. **GET /orders/{id}** - Get order details
3. **POST /orders/{id}/cancel** - Cancel order (with business rule: cannot cancel if shipped)
4. **PATCH /orders/{id}/status** - Update order status (PREPARING, SHIPPED, DELIVERED)
5. **RFC 7807 error responses** for validation/business errors

**File Breakdown:**
- Only 1 file: `order-service.yaml` (will be completely generated)

**Schemas to create:**
- OrderRequest, OrderResponse, OrderItem, Address
- OrderStatus enum
- CancelOrderResponse
- UpdateStatusRequest
- ProblemDetails (RFC 7807)

Proceeding with generation: 

Created [](file:///c%3A/Users/PC1/Desktop/Projects/Education/Java/turkcell-ai-2/docs/openapi/order-service.yaml)

✅ **Complete OpenAPI 3.0.1 specification created for order-service**

**What was generated:**

**Endpoints:**
- `POST /orders` - Create order with validation
- `GET /orders/{id}` - Retrieve order details
- `POST /orders/{id}/cancel` - Cancel order (with shipped/delivered protection)
- `PATCH /orders/{id}/status` - Update order status

**Key Features:**
- All IDs use `format: uuid`
- Timestamps use `format: date-time` (ISO 8601)
- Monetary values use `type: number, format: double`
- RFC 7807 Problem Details for all error responses
- Comprehensive schemas with descriptions and examples
- Status enum: PREPARING, SHIPPED, DELIVERED, CANCELLED
- Security: JWT Bearer token placeholder
- Proper HTTP status codes (201, 204, 400, 404, 422)

The contract is now ready for code generation using the Spring Boot OpenAPI Generator plugin.

Made changes.